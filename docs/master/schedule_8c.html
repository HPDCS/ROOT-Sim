<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>The ROme OpTimistic Simulator: src/arch/x86/linux/schedule-hook/schedule.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="flatdoc.css" rel="stylesheet" type="text/css"/>
<link href="inline-params.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="rs.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The ROme OpTimistic Simulator
   &#160;<span id="projectnumber">2.0.0</span>
   </div>
   <div id="projectbrief">A General-Purpose Multithreaded Parallel/Distributed Simulation Platform</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('schedule_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">schedule.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is the main source for the Linux Kernel Module which implements a schedule-hook module allowing running a custom function each time a thread is cpu rescheduled.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;linux/module.h&gt;</code><br />
<code>#include &lt;linux/kernel.h&gt;</code><br />
<code>#include &lt;linux/fs.h&gt;</code><br />
<code>#include &lt;linux/cdev.h&gt;</code><br />
<code>#include &lt;linux/errno.h&gt;</code><br />
<code>#include &lt;linux/device.h&gt;</code><br />
<code>#include &lt;linux/kprobes.h&gt;</code><br />
<code>#include &lt;linux/mutex.h&gt;</code><br />
<code>#include &lt;linux/mm.h&gt;</code><br />
<code>#include &lt;linux/sched.h&gt;</code><br />
<code>#include &lt;linux/slab.h&gt;</code><br />
<code>#include &lt;linux/version.h&gt;</code><br />
<code>#include &lt;linux/interrupt.h&gt;</code><br />
<code>#include &lt;linux/time.h&gt;</code><br />
<code>#include &lt;linux/string.h&gt;</code><br />
<code>#include &lt;linux/vmalloc.h&gt;</code><br />
<code>#include &lt;linux/preempt.h&gt;</code><br />
<code>#include &lt;asm/atomic.h&gt;</code><br />
<code>#include &quot;ld.h&quot;</code><br />
<code>#include &quot;lend.h&quot;</code><br />
<code>#include &lt;asm/system.h&gt;</code><br />
<code>#include &quot;<a class="el" href="schedule_8h_source.html">schedule.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for schedule.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="schedule_8c__incl.png" border="0" usemap="#src_2arch_2x86_2linux_2schedule-hook_2schedule_8c" alt=""/></div>
<map name="src_2arch_2x86_2linux_2schedule-hook_2schedule_8c" id="src_2arch_2x86_2linux_2schedule-hook_2schedule_8c">
<area shape="rect" id="node20" href="ld_8h_source.html" title="ld.h" alt="" coords="2353,95,2399,121"/>
<area shape="rect" id="node21" href="lend_8h_source.html" title="lend.h" alt="" coords="2423,95,2484,121"/>
<area shape="rect" id="node24" href="schedule_8h.html" title="This is the header file to configure the timestretch module. " alt="" coords="2647,95,2737,121"/>
</map>
</div>
</div>
<p><a href="schedule_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbackup.html">backup</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structinstr.html">instr</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a85c975f662fd2203e47ee4753972f973"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a85c975f662fd2203e47ee4753972f973"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>EXPORT_SYMTAB</b></td></tr>
<tr class="separator:a85c975f662fd2203e47ee4753972f973"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad80f888ec507d366f5b8f0372ed1bc05"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad80f888ec507d366f5b8f0372ed1bc05"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>X86_CR0_WP</b>&#160;&#160;&#160;0x00010000</td></tr>
<tr class="separator:ad80f888ec507d366f5b8f0372ed1bc05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72dbcf6d0153db1b8d8a58001feed83"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad72dbcf6d0153db1b8d8a58001feed83"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEBUG</b>&#160;&#160;&#160;if(1)</td></tr>
<tr class="separator:ad72dbcf6d0153db1b8d8a58001feed83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab24183b1d54ea102e7bf9f64f45ff8c8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab24183b1d54ea102e7bf9f64f45ff8c8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DEBUG_SCHEDULE_HOOK</b>&#160;&#160;&#160;if(1)</td></tr>
<tr class="separator:ab24183b1d54ea102e7bf9f64f45ff8c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3687b23a5e6c8c36636dae2a1629e842"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3687b23a5e6c8c36636dae2a1629e842"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PERMISSION_MASK</b>&#160;&#160;&#160;(S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP | S_IROTH)</td></tr>
<tr class="separator:a3687b23a5e6c8c36636dae2a1629e842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3687b23a5e6c8c36636dae2a1629e842"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3687b23a5e6c8c36636dae2a1629e842"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PERMISSION_MASK</b>&#160;&#160;&#160;(S_IRUSR | S_IRGRP | S_IROTH)</td></tr>
<tr class="separator:a3687b23a5e6c8c36636dae2a1629e842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2984e7d1ef1b264c1f5893898155d8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>synchronize_all</b>()</td></tr>
<tr class="separator:ac2984e7d1ef1b264c1f5893898155d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5471668b6aa3f6678408211811c7969e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>unsynchronize_all</b>()</td></tr>
<tr class="separator:a5471668b6aa3f6678408211811c7969e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a633edc99dac082ba284d52bdd8c8d684"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a633edc99dac082ba284d52bdd8c8d684"></a>
typedef struct <a class="el" href="structbackup.html">backup</a>&#160;</td><td class="memItemRight" valign="bottom"><b>backup_t</b></td></tr>
<tr class="separator:a633edc99dac082ba284d52bdd8c8d684"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8af2131b27c2a8baf878c3ab6a100af"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af8af2131b27c2a8baf878c3ab6a100af"></a>
typedef struct <a class="el" href="structinstr.html">instr</a>&#160;</td><td class="memItemRight" valign="bottom"><b>instr_t</b></td></tr>
<tr class="separator:af8af2131b27c2a8baf878c3ab6a100af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aca4755d2f6b85ff336b8087e308c785f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aca4755d2f6b85ff336b8087e308c785f"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>module_param</b> (the_hook, ulong,(S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH))</td></tr>
<tr class="separator:aca4755d2f6b85ff336b8087e308c785f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef23f196b9ba5b6567ebce3b03ff8b68"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aef23f196b9ba5b6567ebce3b03ff8b68"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>module_param</b> (audit_counter, int,(S_IRUSR|S_IRGRP|S_IROTH))</td></tr>
<tr class="separator:aef23f196b9ba5b6567ebce3b03ff8b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad20533ebbbfbc187cf8e00ffefefd78c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad20533ebbbfbc187cf8e00ffefefd78c"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>synchronize_all_slaves</b> (void *)</td></tr>
<tr class="separator:ad20533ebbbfbc187cf8e00ffefefd78c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c1629663cffe7b82fa1428e321a42a3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c1629663cffe7b82fa1428e321a42a3"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_hook_init</b> (void)</td></tr>
<tr class="separator:a3c1629663cffe7b82fa1428e321a42a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1610cab39cd81201e935ba91d1c131b1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1610cab39cd81201e935ba91d1c131b1"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_unpatch</b> (void)</td></tr>
<tr class="separator:a1610cab39cd81201e935ba91d1c131b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50a9cbfe93e386963d31c37d9f4c2f7c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a50a9cbfe93e386963d31c37d9f4c2f7c"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_patch</b> (void)</td></tr>
<tr class="separator:a50a9cbfe93e386963d31c37d9f4c2f7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f2443acbd457aca2a6cf5b1f2956e00"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1f2443acbd457aca2a6cf5b1f2956e00"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><b>print_bytes</b> (char *str, unsigned char *ptr, size_t s)</td></tr>
<tr class="separator:a1f2443acbd457aca2a6cf5b1f2956e00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ab15fa11bde064e9f885c4d046556ec"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2ab15fa11bde064e9f885c4d046556ec"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_hook</b> (void)</td></tr>
<tr class="separator:a2ab15fa11bde064e9f885c4d046556ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039c4cfddba0d2aef9eb06efbd272686"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a039c4cfddba0d2aef9eb06efbd272686"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_hook_2</b> (void)</td></tr>
<tr class="separator:a039c4cfddba0d2aef9eb06efbd272686"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad94b36675e7eb067ea3ce6ff9e244a44"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad94b36675e7eb067ea3ce6ff9e244a44"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MODULE_LICENSE</b> (&quot;GPL&quot;)</td></tr>
<tr class="separator:ad94b36675e7eb067ea3ce6ff9e244a44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3022e6d2d90c48d76dbf08f85469a148"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3022e6d2d90c48d76dbf08f85469a148"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MODULE_AUTHOR</b> (&quot;Alessandro Pellegrini &lt;pellegrini@dis.uniroma1.it&gt;, Francesco Quaglia &lt;quaglia@dis.uniroma1.it&gt;&quot;)</td></tr>
<tr class="separator:a3022e6d2d90c48d76dbf08f85469a148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b626676fa99b246d1a10de1daa43dfc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8b626676fa99b246d1a10de1daa43dfc"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>MODULE_DESCRIPTION</b> (&quot;Run time patch of the Linux <a class="el" href="core_8h.html#a5b72e8eae05c10259f81fe6250ec813f">kernel</a> scheduler to support the execution of a generic custom function upon thread reschedule&quot;)</td></tr>
<tr class="separator:a8b626676fa99b246d1a10de1daa43dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af98b013e8841e2434e91f68ae8b68b6e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af98b013e8841e2434e91f68ae8b68b6e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>module_init</b> (schedule_hook_init)</td></tr>
<tr class="separator:af98b013e8841e2434e91f68ae8b68b6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc799fce8638df600e3422f4b6fd2c3e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc799fce8638df600e3422f4b6fd2c3e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>module_exit</b> (schedule_unpatch)</td></tr>
<tr class="separator:abc799fce8638df600e3422f4b6fd2c3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1e744bbba323d140db58098f597c725"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae1e744bbba323d140db58098f597c725"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_hook_end</b> (void)</td></tr>
<tr class="separator:ae1e744bbba323d140db58098f597c725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e42121844d246bdf0adb67b00741c9f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5e42121844d246bdf0adb67b00741c9f"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_hook_patch_point</b> (void)</td></tr>
<tr class="separator:a5e42121844d246bdf0adb67b00741c9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dfff04cbf1055da5964885b5fc5a3b0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8dfff04cbf1055da5964885b5fc5a3b0"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>schedule_hook_patch_point_2</b> (void)</td></tr>
<tr class="separator:a8dfff04cbf1055da5964885b5fc5a3b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8c3cc993834c88e4e088b210f8fc991f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8c3cc993834c88e4e088b210f8fc991f"></a>
unsigned long&#160;</td><td class="memItemRight" valign="bottom"><b>the_hook</b> = 0</td></tr>
<tr class="separator:a8c3cc993834c88e4e088b210f8fc991f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40563a45f81c8207c7e38395a63f68b6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a40563a45f81c8207c7e38395a63f68b6"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>audit_counter</b> = 0</td></tr>
<tr class="separator:a40563a45f81c8207c7e38395a63f68b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a219ee450b37a485675fb20b9c1f0e02b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a219ee450b37a485675fb20b9c1f0e02b"></a>
static <a class="el" href="structatomic__t.html">atomic_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>synch_leave</b></td></tr>
<tr class="separator:a219ee450b37a485675fb20b9c1f0e02b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb4a79570fe89e7b4327c4e2f016cd9"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abeb4a79570fe89e7b4327c4e2f016cd9"></a>
static <a class="el" href="structatomic__t.html">atomic_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>synch_enter</b></td></tr>
<tr class="separator:abeb4a79570fe89e7b4327c4e2f016cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ba2cfb2dde3e326d67b6eff2acac935"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2ba2cfb2dde3e326d67b6eff2acac935"></a>
<a class="el" href="structatomic__t.html">atomic_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>count</b></td></tr>
<tr class="separator:a2ba2cfb2dde3e326d67b6eff2acac935"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfe541c47dd8548d96a592e048633b4c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acfe541c47dd8548d96a592e048633b4c"></a>
<a class="el" href="structatomic__t.html">atomic_t</a>&#160;</td><td class="memItemRight" valign="bottom"><b>reference_count</b></td></tr>
<tr class="separator:acfe541c47dd8548d96a592e048633b4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cc3f57cbc62e1cf3f1896cff3c2086b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5cc3f57cbc62e1cf3f1896cff3c2086b"></a>
ulong&#160;</td><td class="memItemRight" valign="bottom"><b>phase</b> = 0</td></tr>
<tr class="separator:a5cc3f57cbc62e1cf3f1896cff3c2086b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6d6d9ad18a8258d23ca531dea937102"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad6d6d9ad18a8258d23ca531dea937102"></a>
void *&#160;</td><td class="memItemRight" valign="bottom"><b>finish_task_switch</b> = (void *)FTS_ADDR</td></tr>
<tr class="separator:ad6d6d9ad18a8258d23ca531dea937102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd08b63464a1655487b6e601b3519164"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd08b63464a1655487b6e601b3519164"></a>
void *&#160;</td><td class="memItemRight" valign="bottom"><b>finish_task_switch_next</b> = (void *)FTS_ADDR_NEXT</td></tr>
<tr class="separator:acd08b63464a1655487b6e601b3519164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50eae215e841a248a57b41353ea85ee2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a50eae215e841a248a57b41353ea85ee2"></a>
<a class="el" href="structbackup.html">backup_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>b</b></td></tr>
<tr class="separator:a50eae215e841a248a57b41353ea85ee2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e32afed7d467cf0aa4a1f931fe2886"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16e32afed7d467cf0aa4a1f931fe2886"></a>
unsigned short int&#160;</td><td class="memItemRight" valign="bottom"><b>backup_count</b> = 0</td></tr>
<tr class="separator:a16e32afed7d467cf0aa4a1f931fe2886"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the main source for the Linux Kernel Module which implements a schedule-hook module allowing running a custom function each time a thread is cpu rescheduled. </p>
<p>Copyright (C) 2014-2017 HPDCS Group <a href="http://www.dis.uniroma1.it/~hpdcs">http://www.dis.uniroma1.it/~hpdcs</a></p>
<p>This is free software; You can redistribute it and/or modify this file under the terms of the GNU General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</p>
<p>This file is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License along with this file; if not, write to the Free Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA</p>
<dl class="section author"><dt>Author</dt><dd>Francesco Quaglia </dd>
<dd>
Alessandro Pellegrini </dd>
<dd>
Emanuele De Santis</dd></dl>
<dl class="section date"><dt>Date</dt><dd>October 15, 2015 </dd></dl>

<p>Definition in file <a class="el" href="schedule_8c_source.html">schedule.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ac2984e7d1ef1b264c1f5893898155d8e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define synchronize_all</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div><div class="line">        printk(<span class="stringliteral">&quot;cpu %d asking from unpreemptive synchronization\n&quot;</span>, smp_processor_id()); <a class="code" href="atomic_8h.html#af7cad706a5bba06487b2011794061922">\</a></div><div class="line"><a class="code" href="atomic_8h.html#af7cad706a5bba06487b2011794061922">		atomic_set</a>(&amp;synch_enter, num_online_cpus() - 1); <a class="code" href="atomic_8h.html#af7cad706a5bba06487b2011794061922">\</a></div><div class="line"><a class="code" href="atomic_8h.html#af7cad706a5bba06487b2011794061922">		atomic_set</a>(&amp;synch_leave, 1); \</div><div class="line">        preempt_disable(); \</div><div class="line">        smp_call_function_many(cpu_online_mask, synchronize_all_slaves, NULL, <span class="keyword">false</span>); <span class="comment">/* false because we manually synchronize */</span> \</div><div class="line">        while(<a class="code" href="atomic_8h.html#a1414350b98d3d1dc33887f9da5878542">atomic_read</a>(&amp;synch_enter) &gt; 0); \</div><div class="line">        printk(<span class="stringliteral">&quot;cpu %d all kernel threads synchronized\n&quot;</span>, smp_processor_id()); \</div><div class="line">    } <span class="keywordflow">while</span>(0)</div><div class="ttc" id="atomic_8h_html_a1414350b98d3d1dc33887f9da5878542"><div class="ttname"><a href="atomic_8h.html#a1414350b98d3d1dc33887f9da5878542">atomic_read</a></div><div class="ttdeci">#define atomic_read(v)</div><div class="ttdoc">Read operation on an atomic counter. </div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00066">atomic.h:66</a></div></div>
<div class="ttc" id="atomic_8h_html_af7cad706a5bba06487b2011794061922"><div class="ttname"><a href="atomic_8h.html#af7cad706a5bba06487b2011794061922">atomic_set</a></div><div class="ttdeci">#define atomic_set(v, i)</div><div class="ttdoc">Set operation on an atomic counter. </div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00069">atomic.h:69</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="schedule_8c_source.html#l00149">149</a> of file <a class="el" href="schedule_8c_source.html">schedule.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5471668b6aa3f6678408211811c7969e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define unsynchronize_all</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { \</div><div class="line">        printk(<span class="stringliteral">&quot;cpu %d freeing other kernel threads\n&quot;</span>, smp_processor_id()); <a class="code" href="atomic_8h.html#af7cad706a5bba06487b2011794061922">\</a></div><div class="line"><a class="code" href="atomic_8h.html#af7cad706a5bba06487b2011794061922">		atomic_set</a>(&amp;synch_leave, 0); \</div><div class="line">        preempt_enable(); \</div><div class="line">    } <span class="keywordflow">while</span>(0)</div><div class="ttc" id="atomic_8h_html_af7cad706a5bba06487b2011794061922"><div class="ttname"><a href="atomic_8h.html#af7cad706a5bba06487b2011794061922">atomic_set</a></div><div class="ttdeci">#define atomic_set(v, i)</div><div class="ttdoc">Set operation on an atomic counter. </div><div class="ttdef"><b>Definition:</b> <a href="atomic_8h_source.html#l00069">atomic.h:69</a></div></div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="schedule_8c_source.html#l00159">159</a> of file <a class="el" href="schedule_8c_source.html">schedule.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_70d5e250c66d001b18da37689179cade.html">arch</a></li><li class="navelem"><a class="el" href="dir_821359b7c7689d1fc53689b7ab64838f.html">x86</a></li><li class="navelem"><a class="el" href="dir_39676abaf64dc3eb9a321884402520a9.html">linux</a></li><li class="navelem"><a class="el" href="dir_2baccd3fb47cecdfe1dd56b98a20940d.html">schedule-hook</a></li><li class="navelem"><a class="el" href="schedule_8c.html">schedule.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
